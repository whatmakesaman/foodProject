<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê´€ë¦¬ì ë¡œê·¸ì¸</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form-style.css') }}">
</head>
<body>

  <div class="top-nav">
    <div class="nav-left">
      <div class="form-icon"><strong>ğŸ”</strong></div>
      <div class="form-title-group">
        <div class="form-title-text">ê´€ë¦¬ì ë¡œê·¸ì¸</div>
        <div class="form-description">
          <span>ì‚¬ì´íŠ¸ ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
        </div>
      </div>
    </div>

    <div class="nav-center"></div>

    <div class="nav-right">
<button class="publish-btn" onclick="location.href='/ranking'">ë­í‚¹ ë³´ê¸°</button>
      <div class="profile-icon">A</div>
    </div>
  </div>

  <div class="main-content">
    <div class="form-container">
      <div class="form-card">

        <div class="form-header">
          <input class="form-title-input" type="text" 
                 value="ê´€ë¦¬ì ì „ìš© ë¡œê·¸ì¸" readonly />
        </div>

        <form id="admin-login-form">
          <div class="form-group">
            <label>ê´€ë¦¬ì ì•„ì´ë””</label>
            <input type="text" id="admin_login_id" class="form-input" required>
          </div>

          <div class="form-group">
            <label>ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="admin_password" class="form-input" required>
          </div>

          <button type="submit" class="publish-btn" style="margin-top:16px;">
            ë¡œê·¸ì¸
          </button>
        </form>

      </div>
    </div>
  </div>

<script>
document.getElementById("admin-login-form").addEventListener("submit", async function (e) {
    e.preventDefault();

    const loginId = document.getElementById("admin_login_id").value;
    const password = document.getElementById("admin_password").value;

    const res = await fetch("/api/admin/login", {   // <- ìƒëŒ€ ê²½ë¡œë¡œ ì¨ë„ ë¨
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ login_id: loginId, password })
    });

    const data = await res.json();

    if (!data.success) {
        alert(data.message);
        return;
    }

    // âœ… ê´€ë¦¬ì ì •ë³´ + isAdmin í”Œë˜ê·¸ ì €ì¥
    localStorage.setItem("isAdmin", "true");
    localStorage.setItem("adminName", data.admin.admin_name);
    localStorage.setItem("adminId", data.admin.admin_id);
    // ê´€ë¦¬ì ë¬¸ì˜ ëª©ë¡ìœ¼ë¡œ ì´ë™ (ê·¸ëŒ€ë¡œ ì‚¬ìš©)
    window.location.href = "/admin_inquiry_list";
});
</script>

</body>
</html>