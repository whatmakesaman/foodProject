<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>ë¬¸ì˜ ìƒì„¸</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form-style.css') }}">

</head>

<body>

    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="top-nav">
        <div class="nav-left">
            <div class="form-icon">ğŸ“„</div>
            <div class="form-title-group">
                <span class="form-title-text">ë¬¸ì˜ ìƒì„¸</span>
            </div>
        </div>

        <div class="nav-right">
            <button class="publish-btn" onclick="location.href='ranking.html'">ë­í‚¹ ëŒì•„ê°€ê¸°</button>
            <button class="publish-btn" id="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content">

        <!-- íƒ­ ë©”ë‰´ -->
        <div class="tab-menu">
            <button class="tab-btn" onclick="location.href='ranking.html'">ë­í‚¹</button>
            <button class="tab-btn active" onclick="location.href='my_inquiry_list.html'">ë¬¸ì˜</button>
        </div>

        <!-- ìƒì„¸ ë‚´ìš© ì¹´ë“œ -->
        <div class="form-card">
            <h2 style="margin-bottom: 12px;">ë¬¸ì˜ ìƒì„¸ ë³´ê¸°</h2>

            <p><strong>ì œëª©</strong></p>
            <p id="title" style="margin-bottom: 16px;"></p>

            <p><strong>ì‘ì„±ì</strong></p>
            <p id="writer" style="margin-bottom: 16px;"></p>

            <p><strong>ì‘ì„±ì¼</strong></p>
            <p id="date" style="margin-bottom: 16px;"></p>

            <p><strong>ë¶„ì•¼</strong></p>
            <p id="field" style="margin-bottom: 16px;"></p>

            <p><strong>ë‚´ìš©</strong></p>
            <p id="content" style="margin-bottom: 16px;"></p>

            <p><strong>ë‹µë³€</strong></p>
            <p id="answer" style="margin-bottom: 16px;"></p>

            <button class="publish-btn" onclick="history.back()">ë’¤ë¡œê°€ê¸°</button>
        </div>

    </div>

<script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    async function loadInquiry() {
        const token = localStorage.getItem("token");

        if (!token) {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            window.location.href = "/login";
            return;
        }

        const res = await fetch(`/api/inquiries/${id}`, {
            headers: {
                "Authorization": `Bearer ${token}`
            }
        });

        const data = await res.json().catch(() => ({}));

        if (!res.ok) {
            alert(data.error || data.message || "ë¬¸ì˜ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }

        document.getElementById("title").innerText = data.title;
        document.getElementById("writer").innerText = data.writer;
        document.getElementById("date").innerText = data.created_at;
        document.getElementById("field").innerText = data.field;
        document.getElementById("content").innerText = data.content;

        document.getElementById("answer").innerText =
            data.answer ? data.answer : "ì•„ì§ ë‹µë³€ì´ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
    }

    loadInquiry();
    
    // ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥
    function logout() {
      if (confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        // localStorageì—ì„œ ëª¨ë“  ì¸ì¦ ì •ë³´ ì œê±°
        localStorage.removeItem("token");
        localStorage.removeItem("user_id");
        localStorage.removeItem("user_name");
        localStorage.removeItem("isAdmin");
        localStorage.removeItem("adminId");
        localStorage.removeItem("admin_name");
        localStorage.removeItem("adminName");
        
        // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
        window.location.href = "/login";
      }
    }
    
    // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í´ë¦­ ì‹œ ë¡œê·¸ì•„ì›ƒ
    document.getElementById("logout-btn").addEventListener("click", logout);
</script>

</body>
</html>
